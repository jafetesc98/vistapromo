import{_ as j}from"./loading.16b03cf4.js";import{_ as F}from"./checked.4cad9791.js";import{v as g,b as n,d as M,e as R,f as b,w as r,N as z,t as k,o as p,g as o,h as f,a as l,C as B,W as K,l as w,i as Z,m as C,X as q,D as y,c as H,O as J,Q as x,p as Q}from"./index.d4fa4833.js";import{_ as W,a as X,b as G}from"./TableDetPrmReg.359e05ce.js";import{g as Y}from"./getData.5726d001.js";const ee=l("img",{src:j,alt:"",class:"block mx-auto"},null,-1),te=l("p",null,"\xBFEst\xE1 seguro que desea eliminar esta promoci\xF3n? ",-1),ae=l("img",{src:F,alt:"",class:"block mx-auto"},null,-1),oe=l("div",null,[x("Creada el: "),l("span",{id:"created_at"})],-1),le=l("div",null,[x("\xDAlt. actualizaci\xF3n: "),l("span",{id:"updated_at"})],-1),se={class:"leading-tight text-lg underline underline-offset-4 font-medium"},ne=l("div",{class:"my-6"},null,-1),re={key:1,class:"leading-tight text-lg underline-offset-4 font-medium mb-6 mt-6 pt-3 pb-3 text-center"},fe={__name:"DetallePromocion",setup(ue){const _=g(()=>s.value.prom),D=Q(),u=n(!0),m=M(),s=n([]),N=g(()=>s.value.suc);async function $(t="",e={}){return(await fetch(t,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)})).json()}const O=g(()=>c.value),T=async function(){let t=await Y(k+"promocion?idprom="+m.numProm+"&compr="+m.nomCto);if(t.ok)await t.json().then(e=>{s.value=e,c.value=s.value.arts,console.log(s.value.arts)});else return console.log("Respuesta de red OK pero respuesta HTTP no OK"),{}},c=n([]),V=n(1);R(async function(){await T();let t=new Date(s.value.prom.created_at),e="------------";s.value.prom.updated_at!=null&&(e=new Date(s.value.prom.updated_at).toLocaleString("es",{timeZone:"America/Chihuahua"})),t=t.toLocaleString("es",{timeZone:"America/Chihuahua"}),document.getElementById("created_at").textContent=t,document.getElementById("updated_at").textContent=e,u.value=!1,V.value=s.value.prom.status,parseInt(V.value)==-1?S():E(),L.value=_.value.tpoProm==1,i.value=_.value.tpoProm});function E(){let t=document.getElementsByClassName("btns");for(let e=0;e<t.length;e++)t[e].classList.add("hidden")}function S(){if(m.nomCto!=s.value.prom.u_alt){console.log("se muestran"),E();return}let t=document.getElementsByClassName("btns");for(let e=0;e<t.length;e++)t[e].classList.remove("hidden")}const v=n(!1),L=n(!0),i=n(),h=n(!1),d=n(!1),P=n("");function U(){h.value=!0}function A(t){return new Promise(e=>setTimeout(e,t))}function I(){u.value=!0,$(k+"delete-prm?idprom="+m.numProm,"").then(async t=>{console.log("respuesta post"),console.log(t),"error"in t?(console.log("Tiene errores"),u.value=!1,P.value="Ocurri\xF3 un error al guardar. "+t.error,v.value=!0):(console.log("NO tiene errores"),u.value=!1,d.value=!0,await A(1500),d.value=!1,D.push({path:"/vistapromo/mis-capturas"}))}),console.log("Eliminado")}return(t,e)=>(p(),b(z,null,{default:r(()=>[o(J,null,{default:r(()=>[o(f,{hasFooter:!1,modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),blocked:!0,title:"Cargando la informaci\xF3n"},{default:r(()=>[ee]),_:1},8,["modelValue"]),o(f,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=a=>h.value=a),title:"Eliminar formato de promoci\xF3n",button:"success",hasFooter:!0,hasButton:"",hasCancel:"",onConfirm:I},{default:r(()=>[te]),_:1},8,["modelValue"]),o(f,{hasFooter:!1,modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),title:"Promoci\xF3n eliminada correctamente",blocked:!0},{default:r(()=>[ae]),_:1},8,["modelValue"]),o(f,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=a=>v.value=a),title:"No se pudo guardar la promoci\xF3n",button:"secondary",hasButton:""},{default:r(()=>[l("p",null,B(P.value),1)]),_:1},8,["modelValue"]),o(K,{title:"Detalle de Promoci\xF3n",hasBack:"/mis-capturas",alto:"h-8",ancho:"w-8"},{default:r(()=>[oe,le,l("div",null,[o(w,{id:"btn_edit",color:"info",class:"hidden btns mr-3",label:"Editar",small:"","data-label":"promo.id",to:"/editar-prom"}),o(w,{id:"btn_delete",color:"danger",class:"hidden btns",label:"Eliminar",small:"","data-label":"promo.id",onClick:U})])]),_:1}),o(Z,{class:"mb-6"},{default:r(()=>[o(W,{prmhdr:C(_),sucs:C(N)},null,8,["prmhdr","sucs"]),o(q),l("h1",se,"Art\xEDculos Capturados: "+B(C(O).length),1),ne,i.value==5||i.value==6?(p(),b(X,{key:0,promos:c.value},null,8,["promos"])):y("",!0),i.value==6?(p(),H("h1",re,"DETALLE DE PRECIOS")):y("",!0),i.value==1||i.value==6?(p(),b(G,{key:2,promos:c.value},null,8,["promos"])):y("",!0)]),_:1})]),_:1})]),_:1}))}};export{fe as default};
