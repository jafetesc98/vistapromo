import{_ as U}from"./loading.16b03cf4.js";import{b as r,p as J,d as j,v as y,o,c as n,F as V,K as O,C as i,D as m,g as u,w as c,h as T,a as s,Q,f as C,m as f,ap as G,l as E,k as F,T as W,t as I,e as X,N as Y,i as M,O as Z,P as ee}from"./index.c79b336d.js";import{_ as te}from"./checked.4cad9791.js";import{_ as ae}from"./SectionTitleLine.8ef5f0dd.js";import{C as se}from"./CardBoxComponentEmpty.6957973c.js";import{g as oe}from"./getData.5726d001.js";const le={key:0,class:"p-3 bg-gray-100/50 dark:bg-slate-800"},re=s("img",{src:U,alt:"",class:"block mx-auto"},null,-1),ne=s("p",null,"\xBFEstas seguro que deseas eliminar esta promoci\xF3n?",-1),ie=s("img",{src:te,alt:"",class:"block mx-auto"},null,-1),ue={class:"px-3"},ce={key:0},de=s("th",{class:"text-center"},"ID PRM",-1),me=s("th",null,"Proveedor",-1),fe=s("th",null,"Descripcion",-1),pe=s("th",{class:"text-center"},"Fec Ini",-1),_e=s("th",{class:"text-center"},"Fec Fin",-1),ve=s("th",{class:"text-center"},"Tipo",-1),be=s("th",{class:"text-center"},"Estado",-1),he=s("th",null,null,-1),ge=["data-label"],ke=["data-label"],Pe=s("br",null,null,-1),ye={class:"text-sm"},Ce=["data-label"],we={key:0,class:"text"},Ve={key:1,class:"text-sm"},Te=["data-label"],Le=["data-label"],Ne=["data-label"],$e=["data-label","data-label1"],Oe=["data-label"],Be={key:2,class:"before:hidden lg:w-1 whitespace-nowrap"},De={key:3,class:"before:hidden lg:w-1 whitespace-nowrap"},Ee={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Fe={__name:"TablePrmDes",props:{checkable:Boolean,promos:[Array,Object],vista:{type:String,default:""}},setup(L){const b=L,d=r(!0);d.value=!1;var p=0,h=0;async function g(t="",a={}){return(await fetch(t,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(a)})).json()}const N=t=>{switch(t){case"0":return"En revisi\xF3n";case"1":return"Autorizada";case"2":return"Descartada";case"-2":return"Eliminada";case"-1":default:return"Por revisar"}},k=t=>{switch(t=parseInt(t),t){case 1:return"Precio Promoci\xF3n";case 2:return"Combo";case 3:return"Precio espec\xEDfico";case 5:return"Mercanc\xEDa sin cargo";case 6:return"Precio + mercanc\xEDa sin cargo";default:return"no identificada"}},_=r(!1);r(!0),r();const P=r(!1),w=r(!1),S=r(""),x=J();j(),r(!1),r(!1);const $=r(10),v=r(0),B=r([]),K=y(()=>b.promos.slice($.value*v.value,$.value*(v.value+1))),D=y(()=>Math.ceil(b.promos.length/$.value)),R=y(()=>v.value+1),A=y(()=>{const t=[];for(let a=0;a<D.value;a++)t.push(a);return t});function H(t){return new Promise(a=>setTimeout(a,t))}function q(t,a){p=t,h=a,P.value=!0}function z(){d.value=!0,console.log("Id promocion: "+p),g(I+"desactivar?idprom="+p+"&tipo="+h,"").then(async t=>{console.log("respuesta post"),console.log(t),"error"in t?(console.log("Tiene errores"),d.value=!1,S.value="Ocurri\xF3 un error al guardar. "+t.error,_.value=!0):(console.log("NO tiene errores"),d.value=!1,w.value=!0,await H(1500),w.value=!1,x.push({path:"/vistapromo/des-prm"}))}),console.log("tipo "+h)}return(t,a)=>(o(),n(V,null,[B.value.length?(o(),n("div",le,[(o(!0),n(V,null,O(B.value,e=>(o(),n("span",{key:e.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-slate-700"},i(e.name),1))),128))])):m("",!0),u(T,{hasFooter:!1,modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value=e),blocked:!0,title:"Cargando la informaci\xF3n"},{default:c(()=>[re]),_:1},8,["modelValue"]),u(T,{modelValue:P.value,"onUpdate:modelValue":a[1]||(a[1]=e=>P.value=e),title:"ELIMINAR",button:"success",hasFooter:!0,hasButton:"",hasCancel:"",onConfirm:z},{default:c(()=>[ne]),_:1},8,["modelValue"]),u(T,{hasFooter:!1,modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value=e),title:"Promoci\xF3n eliminada correctamente",blocked:!0},{default:c(()=>[ie]),_:1},8,["modelValue"]),s("table",ue,[s("thead",null,[s("tr",null,[L.checkable?(o(),n("th",ce)):m("",!0),de,me,fe,pe,_e,ve,be,he])]),s("tbody",null,[(o(!0),n(V,null,O(f(K),e=>(o(),n("tr",{key:e.id},[s("td",{"data-label":e.id+" "+e.tpoProm,to:"/vistapromo/capturar",onClick:a[3]||(a[3]=(...l)=>t.refto&&t.refto(...l)),class:"cursor-pointer text-center"},i(e.id),9,ge),e.nom_prov!=t.NULL?(o(),n("td",{key:0,"data-label":e.id+" "+e.tpoProm,onClick:a[4]||(a[4]=(...l)=>t.refto&&t.refto(...l)),class:"cursor-pointer"},[Q(i(e.proveedor)+" ",1),Pe,s("span",ye,i(e.nom_prov.trim()),1)],8,ke)):m("",!0),e.nom_prov==t.NULL?(o(),n("td",{key:1,"data-label":e.id+" "+e.tpoProm,onClick:a[5]||(a[5]=(...l)=>t.refto&&t.refto(...l)),class:"cursor-pointer"},[e.nom_prov==t.NULL?(o(),n("span",we,i("COMBO"))):m("",!0),e.nom_prov!=t.NULL?(o(),n("span",Ve,i(e.nom_prov.trim()),1)):m("",!0)],8,Ce)):m("",!0),s("td",{"data-label":e.id+" "+e.tpoProm,onClick:a[6]||(a[6]=(...l)=>t.refto&&t.refto(...l)),class:"cursor-pointer"},i(e.desProm),9,Te),s("td",{"data-label":e.id+" "+e.tpoProm,onClick:a[7]||(a[7]=(...l)=>t.refto&&t.refto(...l)),class:"cursor-pointer"},i(e.fec_ini),9,Le),s("td",{"data-label":e.id+" "+e.tpoProm,onClick:a[8]||(a[8]=(...l)=>t.refto&&t.refto(...l)),class:"cursor-pointer"},i(e.fec_fin),9,Ne),s("td",{"data-label":e.id+" "+e.tpoProm,"data-label1":e.tpoProm,class:"uppercase cursor-pointer text-center",onClick:a[9]||(a[9]=(...l)=>t.refto&&t.refto(...l))},i(k(e.tpoProm)),9,$e),s("td",{"data-label":e.id+" "+e.tpoProm,class:"uppercase cursor-pointer text-center",onClick:a[10]||(a[10]=(...l)=>t.refto&&t.refto(...l))},i(N(e.status)),9,Oe),b.vista=="porComprador"?(o(),n("td",Be)):(o(),n("td",De,[u(F,{type:"justify-start lg:justify-end","no-wrap":""},{default:c(()=>[e.status=="1"?(o(),C(E,{key:0,id:"btn_delete",color:"danger",icon:f(G),small:"","data-label":e.id,onClick:l=>q(e.id,e.tpoProm)},null,8,["icon","data-label","onClick"])):m("",!0)]),_:2},1024)]))]))),128))])]),s("div",Ee,[u(W,null,{default:c(()=>[u(F,null,{default:c(()=>[(o(!0),n(V,null,O(f(A),e=>(o(),C(E,{key:e,active:e===v.value,label:e+1,color:e===v.value?"lightDark":"whiteDark",small:"",onClick:l=>v.value=e},null,8,["active","label","color","onClick"]))),128))]),_:1}),s("small",null,"P\xE1gina "+i(f(R))+" de "+i(f(D)),1)]),_:1})])],64))}},Me=s("img",{src:U,alt:"",class:"block mx-auto"},null,-1),Re={__name:"BajaPromociones",setup(L){const b=j(),d=r(!0),p=r(!1),h=y(()=>g.value),g=r([]);r("/vistapromo/capturar");const N=async function(){let k=await oe(I+"des-prm?compr="+b.nomCto);if(k.ok)await k.json().then(_=>{g.value=_});else return console.log("Respuesta de red OK pero respuesta HTTP no OK"),{}};return X(async function(){await N(),p.value=Object.keys(g).length>0,d.value=!1}),(k,_)=>(o(),C(Y,null,{default:c(()=>[u(T,{hasFooter:!1,modelValue:d.value,"onUpdate:modelValue":_[0]||(_[0]=P=>d.value=P),blocked:!0,title:"Cargando la informaci\xF3n"},{default:c(()=>[Me]),_:1},8,["modelValue"]),u(Z,null,{default:c(()=>[u(ae,{icon:f(ee),title:"Promociones MKS",main:""},null,8,["icon"]),p.value?(o(),C(M,{key:0,class:"mb-6","has-table":""},{default:c(()=>[u(Fe,{promos:f(h)},null,8,["promos"])]),_:1})):(o(),C(M,{key:1},{default:c(()=>[u(se)]),_:1}))]),_:1})]),_:1}))}};export{Re as default};
