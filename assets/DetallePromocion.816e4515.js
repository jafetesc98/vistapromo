import{_ as F}from"./loading.16b03cf4.js";import{_ as M}from"./checked.4cad9791.js";import{v as b,b as n,d as R,e as z,f as C,w as r,N as K,t as B,o as p,g as o,h as f,a as l,C as w,W as Z,l as x,i as q,m as y,X as H,D as V,c as J,O as Q,Q as D,p as W}from"./index.f95059b0.js";import{_ as X,a as G,b as Y}from"./TableDetPrmReg.7a7ba8b0.js";import{g as ee}from"./getData.5726d001.js";const te=l("img",{src:F,alt:"",class:"block mx-auto"},null,-1),ae=l("p",null,"\xBFEst\xE1 seguro que desea eliminar esta promoci\xF3n? ",-1),oe=l("img",{src:M,alt:"",class:"block mx-auto"},null,-1),le=l("div",null,[D("Creada el: "),l("span",{id:"created_at"})],-1),se=l("div",null,[D("\xDAlt. actualizaci\xF3n: "),l("span",{id:"updated_at"})],-1),ne={class:"leading-tight text-lg underline underline-offset-4 font-medium"},re=l("div",{class:"my-6"},null,-1),ue={key:1,class:"leading-tight text-lg underline-offset-4 font-medium mb-6 mt-6 pt-3 pb-3 text-center"},_e={__name:"DetallePromocion",setup(ie){const _=b(()=>s.value.prom),E=W(),u=n(!0),m=R(),s=n([]),N=b(()=>s.value.suc);async function $(t="",e={}){return(await fetch(t,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)})).json()}const O=b(()=>c.value),T=async function(){let t=await ee(B+"promocion?idprom="+m.numProm+"&compr="+m.nomCto);if(t.ok)await t.json().then(e=>{s.value=e,c.value=s.value.arts,console.log(s.value.arts)});else return console.log("Respuesta de red OK pero respuesta HTTP no OK"),{}},c=n([]),v=n(1);z(async function(){await T();let t=new Date(s.value.prom.created_at),e="------------";s.value.prom.updated_at!=null&&(e=new Date(s.value.prom.updated_at).toLocaleString("es",{timeZone:"America/Chihuahua"})),t=t.toLocaleString("es",{timeZone:"America/Chihuahua"}),document.getElementById("created_at").textContent=t,document.getElementById("updated_at").textContent=e,u.value=!1,v.value=s.value.prom.status,parseInt(v.value)==-1||parseInt(v.value)==2?S():P(),L.value=_.value.tpoProm==1,i.value=_.value.tpoProm});function P(){let t=document.getElementsByClassName("btns");for(let e=0;e<t.length;e++)t[e].classList.add("hidden")}function S(){if(m.nomCto!=s.value.prom.u_alt){console.log("se muestran"),P();return}let t=document.getElementsByClassName("btns");for(let e=0;e<t.length;e++)t[e].classList.remove("hidden")}const h=n(!1),L=n(!0),i=n(),g=n(!1),d=n(!1),k=n("");function I(){g.value=!0}function U(t){return new Promise(e=>setTimeout(e,t))}function A(){u.value=!0,$(B+"delete-prm?idprom="+m.numProm,"").then(async t=>{console.log("respuesta post"),console.log(t),"error"in t?(console.log("Tiene errores"),u.value=!1,k.value="Ocurri\xF3 un error al guardar. "+t.error,h.value=!0):(console.log("NO tiene errores"),u.value=!1,d.value=!0,await U(1500),d.value=!1,E.push({path:"/vistapromo/mis-capturas"}))}),console.log("Eliminado")}function j(){E.push({path:"/vistapromo/editar-prom"})}return(t,e)=>(p(),C(K,null,{default:r(()=>[o(Q,null,{default:r(()=>[o(f,{hasFooter:!1,modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),blocked:!0,title:"Cargando la informaci\xF3n"},{default:r(()=>[te]),_:1},8,["modelValue"]),o(f,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),title:"Eliminar formato de promoci\xF3n",button:"success",hasFooter:!0,hasButton:"",hasCancel:"",onConfirm:A},{default:r(()=>[ae]),_:1},8,["modelValue"]),o(f,{hasFooter:!1,modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),title:"Promoci\xF3n eliminada correctamente",blocked:!0},{default:r(()=>[oe]),_:1},8,["modelValue"]),o(f,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=a=>h.value=a),title:"No se pudo guardar la promoci\xF3n",button:"secondary",hasButton:""},{default:r(()=>[l("p",null,w(k.value),1)]),_:1},8,["modelValue"]),o(Z,{title:"Detalle de Promoci\xF3n",hasBack:"/mis-capturas",alto:"h-8",ancho:"w-8"},{default:r(()=>[le,se,l("div",null,[o(x,{id:"btn_edit",color:"info",class:"hidden btns mr-3",label:"Editar",small:"","data-label":"promo.id",onClick:j}),o(x,{id:"btn_delete",color:"danger",class:"hidden btns",label:"Eliminar",small:"","data-label":"promo.id",onClick:I})])]),_:1}),o(q,{class:"mb-6"},{default:r(()=>[o(X,{prmhdr:y(_),sucs:y(N)},null,8,["prmhdr","sucs"]),o(H),l("h1",ne,"Art\xEDculos Capturados: "+w(y(O).length),1),re,i.value==5||i.value==6?(p(),C(G,{key:0,promos:c.value},null,8,["promos"])):V("",!0),i.value==6?(p(),J("h1",ue,"DETALLE DE PRECIOS")):V("",!0),i.value==1||i.value==6?(p(),C(Y,{key:2,promos:c.value},null,8,["promos"])):V("",!0)]),_:1})]),_:1})]),_:1}))}};export{_e as default};
