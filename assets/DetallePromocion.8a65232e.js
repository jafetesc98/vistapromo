import{_ as F}from"./loading.16b03cf4.js";import{_ as M}from"./checked.4cad9791.js";import{v as y,b as s,d as R,e as z,f as d,w as u,N as K,t as B,o as c,g as o,h as v,a as l,C as w,W as Z,l as $,i as q,m as k,X as H,D as p,c as J,O as Q,Q as x,p as W}from"./index.f4e78581.js";import{_ as X,a as G,b as Y,c as ee,d as ae}from"./TableDetPrmCmbXPre.5f2c1b70.js";import{g as te}from"./getData.5726d001.js";const oe=l("img",{src:F,alt:"",class:"block mx-auto"},null,-1),le=l("p",null,"\xBFEst\xE1 seguro que desea eliminar esta promoci\xF3n? ",-1),se=l("img",{src:M,alt:"",class:"block mx-auto"},null,-1),ne=l("div",null,[x("Creada el: "),l("span",{id:"created_at"})],-1),re=l("div",null,[x("\xDAlt. actualizaci\xF3n: "),l("span",{id:"updated_at"})],-1),ue={class:"leading-tight text-lg underline underline-offset-4 font-medium"},ie=l("div",{class:"my-6"},null,-1),me={key:3,class:"leading-tight text-lg underline-offset-4 font-medium mb-6 mt-6 pt-3 pb-3 text-center"},he={__name:"DetallePromocion",setup(ce){const h=y(()=>n.value.prom),V=W(),i=s(!0),f=R(),n=s([]),D=y(()=>n.value.suc);async function N(a="",e={}){return(await fetch(a,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)})).json()}const O=y(()=>m.value),T=async function(){let a=await te(B+"promocion?idprom="+f.numProm+"&compr="+f.nomCto);if(a.ok)await a.json().then(e=>{n.value=e,m.value=n.value.arts});else return console.log("Respuesta de red OK pero respuesta HTTP no OK"),{}},m=s([]),g=s(1);z(async function(){await T();let a=new Date(n.value.prom.created_at),e="------------";n.value.prom.updated_at!=null&&(e=new Date(n.value.prom.updated_at).toLocaleString("es",{timeZone:"America/Chihuahua"})),a=a.toLocaleString("es",{timeZone:"America/Chihuahua"}),document.getElementById("created_at").textContent=a,document.getElementById("updated_at").textContent=e,i.value=!1,g.value=n.value.prom.status,parseInt(g.value)==-1||parseInt(g.value)==2?S():E(),L.value=h.value.tpoProm==1,r.value=h.value.tpoProm});function E(){let a=document.getElementsByClassName("btns");for(let e=0;e<a.length;e++)a[e].classList.add("hidden")}function S(){if(f.nomCto!=n.value.prom.u_alt){E();return}let a=document.getElementsByClassName("btns");for(let e=0;e<a.length;e++)a[e].classList.remove("hidden")}const b=s(!1),L=s(!0),r=s(),C=s(!1),_=s(!1),P=s("");function I(){C.value=!0}function U(a){return new Promise(e=>setTimeout(e,a))}function A(){i.value=!0,N(B+"delete-prm?idprom="+f.numProm,"").then(async a=>{console.log("respuesta post"),console.log(a),"error"in a?(console.log("Tiene errores"),i.value=!1,P.value="Ocurri\xF3 un error al guardar. "+a.error,b.value=!0):(console.log("NO tiene errores"),i.value=!1,_.value=!0,await U(1500),_.value=!1,V.push({path:"/vistapromo/mis-capturas"}))}),console.log("Eliminado")}function j(){V.push({path:"/vistapromo/editar-prom"})}return(a,e)=>(c(),d(K,null,{default:u(()=>[o(Q,null,{default:u(()=>[o(v,{hasFooter:!1,modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),blocked:!0,title:"Cargando la informaci\xF3n"},{default:u(()=>[oe]),_:1},8,["modelValue"]),o(v,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=t=>C.value=t),title:"Eliminar formato de promoci\xF3n",button:"success",hasFooter:!0,hasButton:"",hasCancel:"",onConfirm:A},{default:u(()=>[le]),_:1},8,["modelValue"]),o(v,{hasFooter:!1,modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),title:"Promoci\xF3n eliminada correctamente",blocked:!0},{default:u(()=>[se]),_:1},8,["modelValue"]),o(v,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),title:"No se pudo guardar la promoci\xF3n",button:"secondary",hasButton:""},{default:u(()=>[l("p",null,w(P.value),1)]),_:1},8,["modelValue"]),o(Z,{title:"Detalle de Promoci\xF3n",hasBack:"/mis-capturas",alto:"h-8",ancho:"w-8"},{default:u(()=>[ne,re,l("div",null,[o($,{id:"btn_edit",color:"info",class:"hidden btns mr-3",label:"Editar",small:"","data-label":"promo.id",onClick:j}),o($,{id:"btn_delete",color:"danger",class:"hidden btns",label:"Eliminar",small:"","data-label":"promo.id",onClick:I})])]),_:1}),o(q,{class:"mb-6"},{default:u(()=>[o(X,{prmhdr:k(h),sucs:k(D)},null,8,["prmhdr","sucs"]),o(H),l("h1",ue,"Art\xEDculos Capturados: "+w(k(O).length),1),ie,r.value==5||r.value==6?(c(),d(G,{key:0,promos:m.value},null,8,["promos"])):p("",!0),r.value==2?(c(),d(Y,{key:1,promos:m.value},null,8,["promos"])):p("",!0),r.value==3?(c(),d(ee,{key:2,promos:m.value},null,8,["promos"])):p("",!0),r.value==6?(c(),J("h1",me,"DETALLE DE PRECIOS")):p("",!0),r.value==1||r.value==6?(c(),d(ae,{key:4,promos:m.value},null,8,["promos"])):p("",!0)]),_:1})]),_:1})]),_:1}))}};export{he as default};
